//cli version
[artak@amkrtichyan-lin]$ kxi --version
kxi, version 1.11.0rc94 from /home/artak/.local/lib/python3.9/site-packages/kxicli (Python 3.9)


MDAwMSAwQFkqQnBjfkZAbFkoWFFfYU1XVzlSXlR2QChFRm5gXiMjS3h4U2pgIKkDcxAAAACUVWiQ1ClByqxseUl_OQ3rqQTaBnNoYTI1NvMgAAAAsxxXrmJQinvQfrqLL3vsp3Q54x_1NDIXQgE8VPE2JJ7zEAAAAPUJypXXYZadtTd-vAT57-bpwCcJAOkBAAAA
deskGLASS1234%

kubectl create secret docker-registry kxi-image-pull-secret  --docker-server=portal.dl.kx.com  --docker-username=uoteri@kx.com --docker-password=MDAwMSAwQFkqQnBjfkZAbFkoWFFfYU1XVzlSXlR2QChFRm5gXiMjS3h4U2pgIKkDcxAAAACUVWiQ1ClByqxseUl_OQ3rqQTaBnNoYTI1NvMgAAAAsxxXrmJQinvQfrqLL3vsp3Q54x_1NDIXQgE8VPE2JJ7zEAAAAPUJypXXYZadtTd-vAT57-bpwCcJAOkBAAAA -n insights

kubectl create secret generic kxi-license --from-file=license=k4.lic -n insights
kubectl create secret generic kxi-license --from-file=license=k4.lic -n kxi-management
kubectl create secret generic kxi-license --from-file=license=k4.lic -n kxi-operator


//deploy with certs
https://code.kx.com/insights/1.11/enterprise/configuration/base.html#ingress-certificates



oc get ingresscontrollers -n openshift-ingress-operator default -o yaml | grep domain
oc get ingresscontrollers -n openshift-ingress-operator default -o yaml
oc get secret  -n openshift-ingress
oc get secret  -A  | grep custom-tls
oc get secret custom-tls-secret -oyaml -n openshift-ingress
oc get secret custom-tls-secret -oyaml -n openshift-ingress > scotia_cert.yaml
oc apply -f scotia_cert.yaml -n kxi
oc apply -f scotia_cert.yaml -n kxi-management
oc apply -f scotia_cert.yaml -n kxi-operator



//Dev Deployment
kubectl patch storageclass nfs-csi -p '{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}'
kubectl apply -f scotia_dev_cert.yaml
kxi --debug install run --filepath=values.yaml --version 1.17.0 --namespace insights 
kxi --debug install upgrade --version 1.17.0 --operator-version 1.17.0 --management-version 1.0.0 --insights-on-k8s-version 1.1.19 

helm install ingress-nginx ingress-nginx/ingress-nginx \
  --namespace ingress-nginx \
  --create-namespace \
  --set controller.replicaCount=3 \
  --set controller.ingressClassResource.name=nginx-custom \
  --set controller.ingressClass=nginx-custom

helm install ingress-nginx ingress-nginx/ingress-nginx   --namespace ingress-nginx   --create-namespace   --set controller.replicaCount=3   --set controller.ingressClassResource.name=nginx-custom   --set controller.ingressClass=nginx-custom

kxi install delete -n insights
